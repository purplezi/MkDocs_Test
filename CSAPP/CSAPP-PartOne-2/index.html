



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.6.3">
    
    
      
        <title>【考研向】程序结构和执行-程序的机器级表示 - PurpleCypress</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#e91e63">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="pink" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#part-one-machine-level-programming" tabindex="0" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="PurpleCypress" aria-label="PurpleCypress" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              PurpleCypress
            </span>
            <span class="md-header-nav__topic">
              
                【考研向】程序结构和执行-程序的机器级表示
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." class="md-tabs__link">
          简介
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../CSAPP-PartZero/" class="md-tabs__link md-tabs__link--active">
          CSAPP
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Network/ComputerNetwork/" class="md-tabs__link">
          Computer Network
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../English/speaking/" class="md-tabs__link">
          English
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Forensics/image/" class="md-tabs__link">
          Forensics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Linux/Linux/" class="md-tabs__link">
          Linux
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../YOLO/yolo%E5%8E%9F%E7%90%86/" class="md-tabs__link">
          YOLO
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Socket/socket/" class="md-tabs__link">
          Socket
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="PurpleCypress" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    PurpleCypress
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      简介
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        简介
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="首页" class="md-nav__link">
      首页
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      CSAPP
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        CSAPP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CSAPP-PartZero/" title="【考研向】计算机系统基本概念" class="md-nav__link">
      【考研向】计算机系统基本概念
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CSAPP-PartOne-1/" title="【考研向】程序结构和执行-信息的表示和处理" class="md-nav__link">
      【考研向】程序结构和执行-信息的表示和处理
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        【考研向】程序结构和执行-程序的机器级表示
      </label>
    
    <a href="./" title="【考研向】程序结构和执行-程序的机器级表示" class="md-nav__link md-nav__link--active">
      【考研向】程序结构和执行-程序的机器级表示
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ia-32" class="md-nav__link">
    IA-32指令系统
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    指令系统概述
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    计算机硬件的基本组成
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    计算机中数据存储
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    指令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isainstruction-set-architecture" class="md-nav__link">
    指令集体系结构ISA：Instruction Set Architecture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ia-32_1" class="md-nav__link">
    IA-32
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ia-32_2" class="md-nav__link">
    IA-32指令类型
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    传送指令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    C语言语句的机器级表示
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    过程(函数)调用的机器级表示
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    选择和循环语句的机器级表示
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    a. 机器的结构与运行，指令系统的寻址方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    b. 基本数据类型与操作的机器级表示
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c_1" class="md-nav__link">
    c. 基本程序结构的机器级表示
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d" class="md-nav__link">
    d. 缓冲器溢出原理与漏洞攻防
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.处理器体系结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-isa" class="md-nav__link">
    a. ISA的组成与设计
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-cpu" class="md-nav__link">
    b. 顺序结构CPU实现与微操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-cpu" class="md-nav__link">
    c. 流水线CPU基本原理与相关技术
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.优化存储性能
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_1" class="md-nav__link">
    a. 面向编译器的程序优化方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-cpucpucpu" class="md-nav__link">
    b. 面向流水线CPU、超标量CPU、向量CPU的程序优化方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5.存储器层次结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_2" class="md-nav__link">
    a. 存储器层次结构与局部性原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b_1" class="md-nav__link">
    b. 高速缓存技术与基于存储器的程序优化技术
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CSAPP-PartTwo/" title="【考研向】在系统上运行程序" class="md-nav__link">
      【考研向】在系统上运行程序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CSAPP-PartThree/" title="【考研向】程序间的交互和通信" class="md-nav__link">
      【考研向】程序间的交互和通信
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Computer Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Computer Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Network/ComputerNetwork/" title="工大计网" class="md-nav__link">
      工大计网
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      English
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        English
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/speaking/" title="Speaking" class="md-nav__link">
      Speaking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/writing/" title="Writing" class="md-nav__link">
      Writing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/listening/" title="Listening" class="md-nav__link">
      Listening
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/reading/" title="Reading" class="md-nav__link">
      Reading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/reading-hw5-a/" title="Reading-Homework5-1" class="md-nav__link">
      Reading-Homework5-1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/reading-hw5-b/" title="Reading-Homework5-2" class="md-nav__link">
      Reading-Homework5-2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/reading-hw6/" title="Reading-Homework6" class="md-nav__link">
      Reading-Homework6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../English/reading-hw7/" title="Reading-Homework7" class="md-nav__link">
      Reading-Homework7
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Forensics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Forensics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Forensics/image/" title="数字图像取证" class="md-nav__link">
      数字图像取证
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linux/Linux/" title="嵌入式计算机系统实验自救手册" class="md-nav__link">
      嵌入式计算机系统实验自救手册
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linux/Linux_Corresponence_Windows/" title="Linux与Windows文件交互" class="md-nav__link">
      Linux与Windows文件交互
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      YOLO
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        YOLO
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../YOLO/yolo%E5%8E%9F%E7%90%86/" title="yolo原理" class="md-nav__link">
      yolo原理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../YOLO/yolo_spp_code_1/" title="yolo_spp_code_学习笔记1" class="md-nav__link">
      yolo_spp_code_学习笔记1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../YOLO/yolo_spp_code_2/" title="yolo_spp_code_学习笔记2" class="md-nav__link">
      yolo_spp_code_学习笔记2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Socket
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Socket
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Socket/socket/" title="socket基础" class="md-nav__link">
      socket基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ia-32" class="md-nav__link">
    IA-32指令系统
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    指令系统概述
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    计算机硬件的基本组成
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    计算机中数据存储
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    指令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isainstruction-set-architecture" class="md-nav__link">
    指令集体系结构ISA：Instruction Set Architecture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ia-32_1" class="md-nav__link">
    IA-32
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ia-32_2" class="md-nav__link">
    IA-32指令类型
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    传送指令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    C语言语句的机器级表示
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    过程(函数)调用的机器级表示
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    选择和循环语句的机器级表示
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    a. 机器的结构与运行，指令系统的寻址方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    b. 基本数据类型与操作的机器级表示
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c_1" class="md-nav__link">
    c. 基本程序结构的机器级表示
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d" class="md-nav__link">
    d. 缓冲器溢出原理与漏洞攻防
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.处理器体系结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-isa" class="md-nav__link">
    a. ISA的组成与设计
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-cpu" class="md-nav__link">
    b. 顺序结构CPU实现与微操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-cpu" class="md-nav__link">
    c. 流水线CPU基本原理与相关技术
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.优化存储性能
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_1" class="md-nav__link">
    a. 面向编译器的程序优化方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-cpucpucpu" class="md-nav__link">
    b. 面向流水线CPU、超标量CPU、向量CPU的程序优化方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5.存储器层次结构
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a_2" class="md-nav__link">
    a. 存储器层次结构与局部性原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b_1" class="md-nav__link">
    b. 高速缓存技术与基于存储器的程序优化技术
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="part-one-machine-level-programming">【考研黑书向】Part One 程序结构和执行之<u>程序的机器级表示 Machine-Level Programming</u><a class="headerlink" href="#part-one-machine-level-programming" title="Permanent link">&para;</a></h1>
<h2 id="ia-32">IA-32指令系统<a class="headerlink" href="#ia-32" title="Permanent link">&para;</a></h2>
<h3 id="_1">指令系统概述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<h4 id="_2">计算机硬件的基本组成<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p><img alt="计算机最基本部件" src="../img-PartOne/computer-foundamental-component.png" /></p>
<ul>
<li>工作方式：<strong>存储程序</strong><ul>
<li>数据和指令实现存放在存储器中，形式上没有差别</li>
<li>每条指令和每个数据都有地址。指令按序存放，指令由OP、ADDR字段组成<ul>
<li>指令中需给出的信息：<ul>
<li>操作性质(操作码)</li>
<li>源操作数1 或/和 源操作数2(立即数、寄存器编号、<strong>存储地址</strong>)</li>
<li>目的操作数地址(寄存器编号、<strong>存储地址</strong>)</li>
<li>存储地址的描述与<strong>操作数的数据结构</strong>有关</li>
</ul>
</li>
</ul>
</li>
<li>程序由指令组成，程序启动后，计算机自动取出指令执行，程序起始地址在PC中</li>
<li>指令执行过程中，指令和数据被从存储器取到CPU，存放在CPU内的寄存器中，指令在IR(指令寄存器)中，数据在GPR(通用寄存器)中</li>
</ul>
</li>
</ul>
<h4 id="_3">计算机中数据存储<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p><img alt="计算机中数据存储" src="../img-PartOne/datastorage.png" /></p>
<h4 id="_4">指令<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
<th>类比</th>
</tr>
</thead>
<tbody>
<tr>
<td>机器指令</td>
<td>处于硬件和软件的交界面</td>
<td>一个菜谱指定的一个完整做菜过程</td>
</tr>
<tr>
<td>微指令</td>
<td>微程序级命令，属于硬件范畴</td>
<td>洗、切、煮、炒等做菜“微过程”</td>
</tr>
<tr>
<td>伪指令</td>
<td>由若干机器指令组成的指令序列，属于软件范畴</td>
<td>由多个菜谱合成一个”大菜“的过程</td>
</tr>
<tr>
<td>汇编指令</td>
<td>机器指令的汇编表示形式，即符号表示</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>机器指令和汇编指令一一对应，它们都与具体机器结构有关，都属于<strong>机器级指令</strong></li>
</ul>
<h4 id="isainstruction-set-architecture">指令集体系结构ISA：Instruction Set Architecture<a class="headerlink" href="#isainstruction-set-architecture" title="Permanent link">&para;</a></h4>
<ul>
<li>ISA是一种规约（Specification），它规定了如何使用硬件<ul>
<li>可执行的指令的集合，包括<strong>指令格式</strong>、<strong>操作种类</strong>以及每种操作对应的操作数的相应规定；</li>
<li>指令可以接受的<strong>操作数的类型</strong>；</li>
<li>操作数所能存放的寄存器组的结构，包括每个<strong>寄存器的名称、编号、长度和用途</strong>；</li>
<li>操作数所能存放的<strong>存储空间的大小和编址方式</strong>；</li>
<li>操作数在存储空间存放时按照<strong>大端还是小端方式存放</strong>；</li>
<li>指令获取操作数的方式，即<strong>寻址方式</strong>；</li>
<li>指令执行过程的控制方式，包括<strong>程序计数器、条件码定义</strong>等。</li>
</ul>
</li>
<li>ISA在计算机系统中是必不可少的一个<strong>抽象层</strong>，没有它则软件无法使用计算机硬件，一台计算机不能称为“通用计算机”</li>
<li>ISA和计算机组成（微结构）之间的关系<ul>
<li>不同ISA规定的指令集不同，如，IA-32、MIPS、ARM等</li>
<li>计算机组成必须能够<strong>实现</strong>ISA规定的功能，如提供GPR、标志、运算电路等</li>
<li><strong>同一种</strong>ISA可以有<strong>不同的</strong>计算机组成，如乘法指令可用ALU或乘法器实现 </li>
</ul>
</li>
</ul>
<h4 id="ia-32_1">IA-32<a class="headerlink" href="#ia-32_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>体系结构</p>
<p><img alt="IA-32的体系结构" src="../img-PartOne/IA-32.png" /></p>
</li>
<li>
<p>支持的数据类型及格式</p>
<ul>
<li><strong>b</strong>：8位，byte</li>
<li><strong>w</strong>：16位，word</li>
<li><strong>l</strong>：32位，double word</li>
<li>long double实际长度为80位，但分配96位=12B（按4B对齐）</li>
</ul>
<p><img alt="IA-32支持的数据类型及格式" src="../img-PartOne/IA-32-supportdata.png" /></p>
</li>
<li>
<p>IA-32寄存器组织</p>
<ul>
<li>寄存器扩展的方式</li>
<li>首先有8个8位的寄存器：AL、BL...、DH</li>
<li>然后有8个16位的寄存器：AX、BX...、DI</li>
<li>
<p>然后扩展到32位机器的时候，有了8个32位的寄存器，前面的E代表32位：EAX、EBX...、EDI</p>
<p><img alt="IA-32的寄存器组织" src="../img-PartOne/register-organise.png" /></p>
<p><img alt="IA-32的寄存器组织1" src="../img-PartOne/register-organise1.png" /></p>
</li>
<li>
<p>反映了体系结构发展的轨迹，字长不断扩充，指令保持兼容</p>
</li>
<li>ST(0)~ST(7)是80位，MM0~MM7使用其低64位</li>
</ul>
</li>
<li>
<p>IA-32的标志寄存器
    <img alt="IA-32标志寄存器" src="../img-PartOne/flag-register.png" /></p>
<ul>
<li>6个条件标志<ul>
<li>OF、SF、ZF、CF各是什么标志（条件码）</li>
<li>AF：辅助进位标志（BCD码运算时才有意义）</li>
<li>PF：奇偶标志</li>
</ul>
</li>
<li>3个控制标志<ul>
<li>DF（Direction Flag）：方向标志（自动变址方向是增还是减）</li>
<li>IF（Interrupt Flag）：中断允许标志 （仅对外部可屏蔽中断有用）</li>
<li>TF（Trap Flag）：陷阱标志（是否是单步跟踪状态）</li>
</ul>
</li>
</ul>
</li>
<li>
<p>IA-32的<u>寻址方式</u>(如何根据指令所定信息得到操作数或操作数地址)</p>
<ul>
<li>
<p>操作数所在的位置</p>
<ul>
<li>指令中：立即寻址</li>
<li>寄存器中：寄存器寻址</li>
<li>存储单元中（属于存储器操作数，按字节编址）：其他寻址方式</li>
</ul>
</li>
<li>
<p>存储器操作数的寻址方式与微处理器的工作模式有关</p>
<ul>
<li>
<p>实地址模式（基本用不到）</p>
<ul>
<li>为与8086/8088兼容而设，加电或复位时</li>
<li>寻址空间为1MB，20位地址：(CS)&lt;&lt;4+(IP) </li>
</ul>
</li>
<li>
<p>保护模式（需要掌握）</p>
<ul>
<li>加电后进入，采用虚拟存储管理，多任务情况下隔离、保护</li>
<li>80286以上微处理器的工作模式</li>
<li>寻址空间为<span><span class="MathJax_Preview">2^{32}</span><script type="math/tex">2^{32}</script></span>B，32位线性地址分段（段基址+段内偏移量）</li>
</ul>
<p><img alt="保护模式下的寻址方式" src="../img-PartOne/protectmode-addressing.png" /></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>IA-32机器指令格式</p>
<p><img alt="IA-32机器指令格式" src="../img-PartOne/IA-32-machine-instruction.png" /></p>
</li>
</ul>
<h2 id="ia-32_2">IA-32指令类型<a class="headerlink" href="#ia-32_2" title="Permanent link">&para;</a></h2>
<h3 id="_5">传送指令<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>通用数据传送指令</li>
<li>
<p>地址传送指令</p>
<ul>
<li>lea：加载有效地址load effective address</li>
<li>如<code>leal (%edx,%eax),%eax</code>的功能为<code>R[eax]⬅R[edx]+R[eax]</code>，意思是把寄存器的内容取出来，把进行加法运算后的和，作为数据装入到eax中，执行前若R[edx]=i，R[eax]=j，则指令执行后R[eax]=i+j，此处的R表示寄存器register<ul>
<li>(%edx,%eax)，edx的内容，相当于是基址值，加上eax的内容，相当于是变址值，基址+变址，两个寄存器的内容加起来是有效地址</li>
</ul>
</li>
</ul>
</li>
<li>
<p>输入输出指令</p>
</li>
<li>标志传送指令</li>
</ul>
<hr />
<p>【例一】“入栈”(pushw %ax)的解释过程</p>
<p><img alt="pushw" src="../img-PartOne/pushw.png" /></p>
<ul>
<li>将通用寄存器的内容送到栈顶位置所指的数据</li>
<li>w是16位，ax是16位寄存器</li>
<li>按4B对齐，所以一个横格为32位，即2个ax</li>
<li>小端方式，所以AL在栈顶，LSB在低地址</li>
<li>栈由高地址向低地址增长</li>
<li>
<p>过程为：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code># 取栈顶指针sp寄存器中的值
# 将栈顶指针向下移一个ax的距离(2个字节)，即-2
# 让sp指向新的栈顶
R[sp]⬅R[sp]-2
# 把ax中的值压栈，意思是将ax的值 = 以栈顶指针sp的值为内存地址的那块单元的所存的值
# 即在新的栈顶处把ax的内容放入
# M表示内存 memory
M[R[sp]]⬅R[ax]
</code></pre></div>
</td></tr></table>
</li>
</ul>
<p>【例二】“出栈”(popw %ax)</p>
<p><img alt="popw" src="../img-PartOne/popw.png" /></p>
<ul>
<li>将栈顶位置所指的数据送到通用寄存器</li>
<li>
<p>过程为：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code># 原栈顶处指向的两个字节送入ax
R[ax]⬅M[R[sp]]
# 让sp指向新的栈顶
R[sp]⬅R[sp]+2
</code></pre></div>
</td></tr></table>
</li>
</ul>
<p>【例三】传送指令举例</p>
<p>将以下Intel格式指令转换为AT&amp;T格式指令，并说明功能。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nf">push</span>   <span class="no">ebp</span> 
<span class="no">mov</span>    <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
<span class="nf">mov</span>    <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nf">mov</span>    <span class="no">bl</span><span class="p">,</span> <span class="mi">255</span>
<span class="nf">mov</span>    <span class="no">ax</span><span class="p">,</span> <span class="no">WORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">edx</span><span class="p">*</span><span class="mi">4</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
<span class="nf">mov</span>    <span class="no">WORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="mi">20</span><span class="p">],</span><span class="no">dx</span>
<span class="nf">lea</span>    <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ecx</span><span class="err">+</span><span class="no">edx</span><span class="p">*</span><span class="mi">4</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>push==l==  %ebp <u>R[esp]⬅R[esp]-4;M[R[esp]]⬅R[ebp]</u></p>
<p>mov==l==   %esp,%ebp <u>R[ebp]⬅R[esp]</u></p>
<p>movl  8(%ebp),%edx <u>R[edx]⬅M[R[ebp]+8]</u></p>
<p>movb  $255,%bl <u>R[bl]⬅255</u></p>
<p>movw  8(%ebp,%edx,4),%ax <u>R[ax]⬅M[R[ebp]+R[edx]*4+8]</u></p>
<p>movw  %dx,20(%ebp) <u>M[R[ebp]+20]⬅R[dx]</u></p>
<p>lea==l==   8(%ecx,%edx,4),%eax <u>R[eax]⬅R[ecx]+R[edx]*4+8</u></p>
</blockquote>
<ul>
<li>如何判断第1，2，7句是l，因为题目中都是e，所以是<strong>双字</strong></li>
<li>总结规律：<ul>
<li>mov指令需要在算出有效地址后加上M，而lea直接是有效地址</li>
<li>push的第二条相当于mov指令1</li>
</ul>
</li>
</ul>
<p>【例四】add函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">int</span> <span class="n">j</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p><img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" />表示传送指令；加粗表示操作数；横线表示用RTL描述的传送指令的功能</p>
<blockquote>
<p>80483d4&lt;<strong>add</strong>&gt;:</p>
<p>80483d4: <strong>55</strong>        push   %ebp <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[sp]⬅R[sp]-2;M[R[sp]]⬅R[ebp]</u></p>
<p>80483d5: <strong>89</strong> e5     mov    %esp, %ebp <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[ebp]⬅R[esp]</u></p>
<p>80483d7: <strong>83</strong> ec 10  sub    $0x10, %esp</p>
<p>80483da: <strong>8b</strong> 45 0c  mov    0xc(%ebp), %eax <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[eax]⬅M[R[ebp]+12]</u></p>
<p>80483dd: <strong>8b</strong> 55 08  mov    0x8(%ebp), %edx <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[edx]⬅M[R[ebp]+8]</u></p>
<p>80483e0: <strong>8d</strong> 04 02  lea    (%edx,%eax,1), %eax <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[eax]⬅R[edx]+R[eax]*1</u></p>
<p>80483e3: <strong>89</strong> 45 fc  mov    %eax, -0x4(%ebp) <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>M[R[ebp]-4]⬅R[eax]</u></p>
<p>80483e6: <strong>8b</strong> 45 fc  mov    -0x4(%ebp), %eax <img alt="⭐️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/2b50.svg" title=":star:" /> <u>R[eax]⬅M[R[ebp]-4]</u></p>
<p>80483e9: <strong>c9</strong>        leave  </p>
<p>80483ea: <strong>c3</strong>        ret</p>
</blockquote>
<p>程序的执行过程</p>
<ul>
<li>周而复始：根据EIP取指令；指令译码；取操作数；指令执行；回写结果；修改EIP的值</li>
<li>add函数从80483d4开始，EIP⬅0x80483d4</li>
</ul>
<p><img alt="" src="../img-PartOne/d4d5.png" /></p>
<ol>
<li>
<p>取指令</p>
<ul>
<li>取指令的过程是把指令地址送到地址线和存储器的过程</li>
<li>EIP中最初存的是函数开始地址80483d4，将该值传输给<u>MAR</u>(存储地址寄存器，MAR为下一次的读写数据指定位置)，再送到<u>地址线</u>上</li>
<li>此时控制器发出<strong>Rd</strong>读命令，送到控制线上，告诉存储器要读地址线上所给的单元的内容</li>
<li>存储器接收到读命令和地址后，开始进行读操作，选中该地址，读出4个字节5589e583，把地址上的内容传输到数据线上</li>
<li>数据传输到MDR(存储数据寄存器，MDR存储从内存交换的数据)，然后传给指令寄存器IR</li>
</ul>
</li>
<li>
<p>指令译码</p>
<ul>
<li>指令寄存器中的高位，即op字段，会送到控制器，在控制器中进行译码</li>
<li>55译码后，计算机知道该指令的功能，即为<code>R[esp]⬅R[esp]-4;M[R[esp]]⬅R[ebp]</code></li>
<li>译码的结果产生了很多控制信号，控制信号控制机器实现功能</li>
</ul>
</li>
<li>
<p>指令执行</p>
<ul>
<li>
<p><code>R[esp]⬅R[esp]-4</code>：ESP的初始内容是<code>bfff0000</code>，将ESP-4后的内容变为<code>beeefffc</code>(ESP的最初内容实际上是被送入ALU中，在ALU中实现-4，结果再送回ESP中)</p>
<p><img alt="esp-4" src="../img-PartOne/esp-4.png" /></p>
</li>
<li>
<p><code>M[R[esp]]⬅R[ebp]</code>：根据esp的内容去存储器访问，将ebp的内容写入对应位置</p>
<ul>
<li>
<p>将地址先送入MAR，然后再送入地址线，同时控制器发出Wr写信号放到控制线上，并且要把写的数据即EBP的内容放到MDR中，然后送到数据线上</p>
<p><img alt="esp-ebp" src="../img-PartOne/esp-ebp.png" /></p>
</li>
<li>
<p>存储器最终接收到的消息是：接受写的控制信号，把数据线上的<code>bfff0020</code>值写入地址<code>beeefffc</code>处</p>
<p><img alt="esp-ebp1" src="../img-PartOne/esp-ebp1.png" /></p>
</li>
</ul>
</li>
<li>
<p>至此push指令执行完，对EIP(IA32中的PC：程序计数器)增量，即在EIP中加上指令的长度，由于push指令(55)只有一个字节，所以EIP由<code>80483d4</code>变化为<code>80483d5</code>，即下一条指令的地址，开始执行下一条指令</p>
</li>
<li>传送指令如果是在寄存器和寄存器之间的传送，则只需要在寄存器之间传输；如果涉及到访问内存，则需要总线进行传输</li>
</ul>
</li>
</ol>
<h2 id="c">C语言语句的机器级表示<a class="headerlink" href="#c" title="Permanent link">&para;</a></h2>
<p>可执行文件的存储器映像</p>
<p><img alt="存储器映像" src="../img-PartOne/storage.png" /></p>
<h3 id="_6">过程(函数)调用的机器级表示<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><strong>过程调用的执行步骤</strong></p>
<p>P为调用者，Q为被调用者</p>
<p>P的过程：</p>
<ol>
<li>P将入口参数(实参)放到Q能访问到的地方</li>
<li><strong>CALL指令</strong>：P保存返回地址，然后将控制转移到Q</li>
</ol>
<p>Q的过程：</p>
<ol>
<li>准备阶段：Q保存P的现场，并为自己的<strong>非静态局部变量</strong>分配空间</li>
<li>处理阶段：执行Q的过程体(函数体)</li>
<li>结束阶段：Q恢复P的现场，释放局部变量空间</li>
<li>结束阶段RET指令：Q取出返回地址，将控制转移到P</li>
</ol>
<p>现场：通用寄存器的内容。因为所有过程共享一套通用寄存器
- 调用者保存寄存器：EAX、EDX、ECX。即当过程P调用过程Q时，Q可以直接使用这三个寄存器，不用将他们的值保存到栈中。如果P在从Q返回后还要用这三个寄存器，则P应在转到Q之前先保存，并在从Q返回后先恢复它们的值再使用。为了减少准备和结束阶段的开销，应先使用这三个寄存器
- 被调用者保存寄存器：EBX、ESI、EDI。即Q必须先将它们的值保存到栈中再使用它们，并在返回P之前恢复它们的值
- EBP和ESP分别是帧指针寄存器和栈指针寄存器，分别用来指向当前栈帧的底部和顶部</p>
<p><img alt="栈帧变化" src="../img-PartOne/stackframe.png" /></p>
<p>【例子】</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">caller</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">125</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">t2</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>pushl  %ebp <img alt="👻" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47b.svg" title=":ghost:" /> 准备阶段</p>
<p>movl   %esp,%ebp <img alt="👻" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47b.svg" title=":ghost:" /> 准备阶段</p>
<p>subl   $24,%esp <img alt="👻" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47b.svg" title=":ghost:" /> 准备阶段</p>
<p>movl   $125,-12(%ebp) <img alt="👽" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47d.svg" title=":alien:" /> 分配局部变量</p>
<p>movl   $80,-8(%ebp) <img alt="👽" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47d.svg" title=":alien:" /> 分配局部变量</p>
<p>movl   -8(%ebp),%eax <img alt="🤖" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f916.svg" title=":robot:" /> 准备入口参数</p>
<p>movl   %eax,4(%esp) <img alt="🤖" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f916.svg" title=":robot:" /> 准备入口参数</p>
<p>movl   -12(%ebp),%eax <img alt="🤖" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f916.svg" title=":robot:" /> 准备入口参数</p>
<p>movl   %eax,(%esp) <img alt="🤖" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f916.svg" title=":robot:" /> 准备入口参数</p>
<p>call   add</p>
<p>movl   %eax,-4(%ebp) <img alt="👾" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47e.svg" title=":space_invader:" /> 准备返回参数</p>
<p>movl   -4(%ebp),%eax <img alt="👾" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f47e.svg" title=":space_invader:" /> 准备返回参数</p>
<p>leave  <img alt="👹" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f479.svg" title=":japanese_ogre:" /> 结束阶段 <code>movl %ebp,%esp; popl %ebp</code></p>
<p>ret    <img alt="👹" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f479.svg" title=":japanese_ogre:" /> 结束阶段</p>
</blockquote>
<p><img alt="" src="../img-PartOne/addfunc-stackframe.png" /></p>
<p>详细解析:</p>
<ol>
<li>在调用者caller的准备阶段，将原有的栈底ebp(即调用caller的函数的栈帧栈底)的值入栈；然后将现在的栈顶esp给ebp，即ebp成为新的栈帧的栈底；esp-24，即栈顶指针往低地址移动24个字节，定位到新的栈顶，至此caller的栈帧形成</li>
<li><code>int t1=125;int t2=80对应movl $125,-12(%ebp);movl $80,-8(%ebp)</code>是在分配局部变量。将ebp-12位置处的内容置为125，即t1的位置；将ebp-8位置处的内容置为80，即t2的位置。<u>为什么要反着存</u></li>
<li>因为add函数需要两个参数，所以要在调用add前，将add所需要的参数放在add能够访问的位置。参数压栈的顺序是从右往左，所以第一步是将t2压栈，<code>movl -8(%ebp),%eax</code>，即把ebp-8处即t2处的值赋给eax，然后<code>movl %eax,4(%esp)</code>是将eax的值赋给esp+4(esp往高地址)所在位置的值；第二步将t1压栈，<code>movl -12(%ebp),%eax</code>，即把ebp-12处即t1处的值赋给eax，然后<code>movl %eax,(%esp)</code>是将eax的值赋给esp所在位置的值</li>
<li>call add即caller先保存返回地址，即call add下一条指令的地址，然后再调用add函数，将控制权移交给add</li>
<li>add函数开始时，先要<code>pushl %ebp;movl %esp,%ebp</code>，即保存caller栈帧的指向栈底的ebp指针的值，然后将现在的esp的值赋给ebp，ebp即为新栈帧的栈底，即add函数的栈底</li>
<li>add函数执行结束，返回caller函数。add函数的返回参数总储存在eax中</li>
<li>caller函数要获得add函数返回的结果，需要将eax中存的值赋值给ebp-4，即图中的sum</li>
<li>由于caller函数也需要将sum结果返回给上一个调用它的函数，所以caller函数中把sum的值传给了eax寄存器</li>
<li>caller函数执行leave指令，即把ebp的值给esp，即退栈，esp往高地址移动，caller的栈帧“消失”，esp是作为调用caller的函数的栈帧栈顶；然后再把栈顶的原来压栈的调用caller的函数的EBP值出栈，EBP为调用caller的函数的栈帧的栈底，调用caller函数的栈帧恢复</li>
<li>ret表示caller函数调用结束，回归到调用caller函数继续执行</li>
</ol>
<p><strong>总结：一个C过程的大致结构如下：</strong></p>
<ul>
<li>
<p>准备阶段</p>
<ul>
<li>形成帧底：push指令 和 mov指令</li>
<li>生成栈帧（如果需要的话）：sub指令 或 and指令</li>
<li>保存现场（如果有被调用者保存寄存器） ：mov指令</li>
</ul>
</li>
<li>
<p>过程(函数)体</p>
<ul>
<li>分配局部变量空间，并赋值</li>
<li>
<p>具体处理逻辑，如果遇到函数调用时</p>
<ul>
<li>准备参数：将实参送栈帧入口参数处</li>
<li>CALL指令：保存返回地址并转被调用函数</li>
</ul>
</li>
<li>
<p>在EAX中准备返回参数</p>
</li>
</ul>
</li>
<li>
<p>结束阶段</p>
<ul>
<li>退栈：leave指令 或 pop指令</li>
<li>取返回地址返回：ret指令</li>
</ul>
</li>
</ul>
<p><strong>入口参数的位置</strong></p>
<p><img alt="入口参数" src="../img-PartOne/parameter-entrance.png" /></p>
<p><strong>按地址传递参数和按值传递参数</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// 程序一</span>
<span class="c1">// 按地址传递参数</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">22</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;a=%d</span><span class="se">\t</span><span class="s">b=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
    <span class="n">swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;a=%d</span><span class="se">\t</span><span class="s">b=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">y</span> <span class="p">){</span>
    <span class="kt">int</span> <span class="n">t</span><span class="o">=*</span><span class="n">x</span><span class="p">;</span>
    <span class="o">*</span><span class="n">x</span><span class="o">=*</span><span class="n">y</span><span class="p">;</span>
    <span class="o">*</span><span class="n">y</span><span class="o">=</span><span class="n">t</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 程序二</span>
<span class="c1">// 按值传递参数</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">22</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;a=%d</span><span class="se">\t</span><span class="s">b=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
    <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;a=%d</span><span class="se">\t</span><span class="s">b=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">swap</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="p">){</span>
    <span class="kt">int</span> <span class="n">t</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
    <span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
    <span class="n">y</span><span class="o">=</span><span class="n">t</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>按地址传递参数</p>
<p><img alt="" src="../img-PartOne/address-past.png" /></p>
<p>按值传递参数</p>
<p><img alt="" src="../img-PartOne/value-past.png" /></p>
<p><strong>递归过程 - 好难理解哇呜呜呜</strong></p>
<p><img alt="" src="../img-PartOne/recursion.png" /></p>
<p><img alt="" src="../img-PartOne/recursion1.png" /></p>
<p>【例二】</p>
<p><img alt="" src="../img-PartOne/protecterror.png" /></p>
<h3 id="_7">选择和循环语句的机器级表示<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<h2 id="a">a. 机器的结构与运行，指令系统的寻址方式<a class="headerlink" href="#a" title="Permanent link">&para;</a></h2>
<h2 id="b">b. 基本数据类型与操作的机器级表示<a class="headerlink" href="#b" title="Permanent link">&para;</a></h2>
<h2 id="c_1">c. 基本程序结构的机器级表示<a class="headerlink" href="#c_1" title="Permanent link">&para;</a></h2>
<h2 id="d">d. 缓冲器溢出原理与漏洞攻防<a class="headerlink" href="#d" title="Permanent link">&para;</a></h2>
<h2 id="3">3.处理器体系结构<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="a-isa">a. ISA的组成与设计<a class="headerlink" href="#a-isa" title="Permanent link">&para;</a></h3>
<h3 id="b-cpu">b. 顺序结构CPU实现与微操作<a class="headerlink" href="#b-cpu" title="Permanent link">&para;</a></h3>
<h3 id="c-cpu">c. 流水线CPU基本原理与相关技术<a class="headerlink" href="#c-cpu" title="Permanent link">&para;</a></h3>
<h2 id="4">4.优化存储性能<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="a_1">a. 面向编译器的程序优化方法<a class="headerlink" href="#a_1" title="Permanent link">&para;</a></h3>
<h3 id="b-cpucpucpu">b. 面向流水线CPU、超标量CPU、向量CPU的程序优化方法<a class="headerlink" href="#b-cpucpucpu" title="Permanent link">&para;</a></h3>
<h2 id="5">5.存储器层次结构<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="a_2">a. 存储器层次结构与局部性原理<a class="headerlink" href="#a_2" title="Permanent link">&para;</a></h3>
<h3 id="b_1">b. 高速缓存技术与基于存储器的程序优化技术<a class="headerlink" href="#b_1" title="Permanent link">&para;</a></h3>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../CSAPP-PartOne-1/" title="【考研向】程序结构和执行-信息的表示和处理" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                【考研向】程序结构和执行-信息的表示和处理
              </span>
            </div>
          </a>
        
        
          <a href="../CSAPP-PartTwo/" title="【考研向】在系统上运行程序" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                【考研向】在系统上运行程序
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/purplezi" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.1.2",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="https://unpkg.com/mermaid@8.0.0-rc.8/dist/mermaid.min.js"></script>
      
    
  </body>
</html>